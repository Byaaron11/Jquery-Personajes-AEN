<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body{
            background-color: black;
            color: white;
        }
    </style>
</head>
<body>
    <div id="menu-container"></div>
    <h1 class="display-4">Tabla de Apuestas</h1>
    <div class="container text-center" id="botones"></div>
    <div class="container text-center" id="tabla-apuesta"></div>

    <script src="../js/jquery-3.6.1.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function(){
            $("#menu-container").load('/../Menu.html');
            document.title = "Apuestas";
            var request = "/api/apuestas";
            var url = "https://apichampions.azurewebsites.net"+request;
            $.ajax({
                "url": url,
                "method":"GET",
                "success": function(data){
                    var tabla = $("<table>",{"class":"table table-dark"});
                    var cab = $("<thead>");
                    var filaCab = $("<tr>");
                    var celdaCab1 = $("<th>Usuario</th>");
                    var celdaCab2 = $("<th>Resultado</th>");
                    var celdaCab3 = $("<th>Fecha</th>");
                    var celdaCab4 = $("<th>Acci√≥n</th>");   
                    var bod = $("<tbody>");               
                    celdaCab1.appendTo(filaCab);
                    celdaCab2.appendTo(filaCab);
                    celdaCab3.appendTo(filaCab);
                    celdaCab4.appendTo(filaCab);
                    filaCab.appendTo(cab);
                    cab.appendTo(tabla);
                    bod.appendTo(tabla);
                    $.each(data, function(index, apuesta){
                        var fila = $("<tr>");
                        var celda1 = $("<td>"+apuesta.usuario+"</td>");
                        var celda2 = $("<td>"+apuesta.resultado+"</td>");
                        var celda3 = $("<td>"+apuesta.fecha+"</td>");
                        var celda4 = $("<td>");                        
                        var botonDelete = $("<button>",{"data-id":apuesta.idApuesta, "text":"Eliminar", "class":"btn btn-outline-warning"});
                        fila.appendTo(bod);
                        celda1.appendTo(fila);
                        celda2.appendTo(fila);
                        celda3.appendTo(fila);
                        celda4.appendTo(fila);
                        botonDelete.appendTo(celda4);
                        botonDelete.click(function(){
                            window.location.href = "EliminarApuesta.html?idApuesta="+apuesta.idApuesta+"&name="+apuesta.usuario;                            
                        }); 
                    });
                    tabla.appendTo($("#tabla-apuesta"));
                }
            });
            var botonVolver = $("<button>", {
                "text":"Volver",
                "class":"btn btn-secondary"
            });
            var botonCrearApuesta = $("<button>",{
                "text": "Crear apuesta",
                "class":"btn btn-primary"
            });
            botonVolver.appendTo($("#botones"));
            botonCrearApuesta.appendTo($("#botones"));
            botonVolver.click(function(){
                window.location.href= "../index.html";
            });
            botonCrearApuesta.click(function(){
                window.location.href = "CrearApuesta.html";
            });
            
        });
    </script>
</body>
</html>
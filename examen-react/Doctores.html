<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body{
            background-color: black;
            color: white;
        }
    </style>
</head>
<body>
    <div id="menu-container"></div>
    <div class="container text-center">
        <div class="row justify-content-center">
            <h1 id="cabecera" class="display-3"></h1>
            <div class="col-2">
              <!-- aqui no se dibuja nada, es para que la tabla se vea en el centro -->
            </div>
            <div id="resultado" class="col-6">
              <!-- AQUI VA IR LA TABLA -->
            </div>
            <div class="col-2">
             <!-- aqui no se dibuja nada, es para que la tabla se vea en el centro -->
            </div>
          </div>
        <button class="btn btn-light" onclick=volverAtras()>
            Volver
        </button>
    </div>
    <script src="../js/jquery-3.6.1.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script>
        //Obtengo los parÃ¡metros de la URL que enviaba desde Incremento.html
        var parametro1 = window.location.search;
        const urlParams = new URLSearchParams(parametro1);
        var esp = urlParams.get('esp');// -> "cardiologo"
        
        var parametro2 = window.location.search;
        const urlParams2 = new URLSearchParams(parametro2);
        var inc = urlParams2.get('inc');// -> number ej: 0
        //A partir de aqui hago la peticion a la Api utilizando los 2 parametros
        $(document).ready(function(){
            $("#menu-container").load('/../Menu.html');
            $("#cabecera").text("Doctores de "+esp);
            var request = "/api/Doctores/"+esp+"/"+inc;
            var url = "https://apicruddoctores.azurewebsites.net" + request;
            $.ajax({
                "url": url,
                "method":"PUT",
                "success": function(){
                    mostrarTabla();
                }
            })
        });
        function mostrarTabla() {
            var request = "/api/Doctores/DoctoresEspecialidad/"+esp;
            var url = "https://apicruddoctores.azurewebsites.net" + request;
            $.ajax({
                "url":url,
                "type":"GET",
                "success":function(data){
                    var html = "<table border=1 class='table table-light table-dark table-striped-columns'>";
                    html += "<thead>";
                    html += "<tr>";
                    html += "<th>Apellido</th>";
                    html += "<th>Especialidad</th>";
                    html += "<th>Salario</th>";
                    html += "</tr>";
                    html += "</thead>";
                    html += "<tbody>";
                    $.each(data, function(key, doc){
                        html += "<tr>";
                        html += "<td style='background-color:yellow; color: black'>"+doc.apellido+"</td>";
                        html += "<td>"+doc.especialidad+"</td>";
                        html += "<td style='color:yellow'>"+doc.salario+"</td>";
                        html += "</tr>";
                    });
                    html += "</tbody>";
                    html += "</table>";
                    $("#resultado").html(html);                
                }
            });
        }
        function volverAtras(){
            window.location.href = "Incremento.html";
        }

    </script>
</body>
</html>